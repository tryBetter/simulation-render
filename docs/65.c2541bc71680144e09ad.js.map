{"version":3,"file":"65.c2541bc71680144e09ad.js","mappings":"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","sources":["webpack://babylonjs-fluid-rendering/./src/scenes/fluidSimulationDemoHeightMap.ts"],"sourcesContent":["import * as BABYLON from \"@babylonjs/core\";\n\nimport { FluidSimulationDemoBase } from \"./fluidSimulationDemoBase\";\nimport { ParticleGenerator } from \"./Utils/particleGenerator\";\nimport { ICollisionShape } from \"./Utils/sdfHelper\";\n\nexport class FluidSimulationDemoHeightMap extends FluidSimulationDemoBase {\n    private _particleGeneratorName: string;\n    private _sphere: BABYLON.Nullable<BABYLON.Mesh>;\n    private _box: BABYLON.Nullable<BABYLON.Mesh>;\n    private _heightMap: [\n        BABYLON.Nullable<BABYLON.Mesh>,\n        BABYLON.Nullable<ICollisionShape>\n    ];\n    private _ground: BABYLON.Mesh;\n    private _groundCollision: ICollisionShape;\n    private _time: number;\n    private _showHeightmap: boolean;\n\n    constructor(scene: BABYLON.Scene) {\n        super(scene, false);\n\n        this._numParticles = 10000;\n        this._particleGeneratorName = \"Water jet\";\n        this._time = 0;\n        this._showHeightmap = true;\n        this._sphere = null;\n        this._box = null;\n        this._heightMap = [null, null];\n        this._groundCollision = null as any;\n\n        const terrainSize = 2.85;\n\n        this.addCollisionSphere(new BABYLON.Vector3(0, 0.2, 0), 0.2, null);\n        this.addCollisionBox(\n            new BABYLON.Vector3(-0.7, 0.249, -0.7),\n            new BABYLON.Vector3(0, 0, (90 * Math.PI) / 180),\n            new BABYLON.Vector3(0.2, 0.05, 0.5)\n        );\n\n        this.addCollisionTerrain(terrainSize);\n\n        this.addCollisionPlane(new BABYLON.Vector3(0, 0, -1), terrainSize / 2);\n        this.addCollisionPlane(new BABYLON.Vector3(0, 0, 1), terrainSize / 2);\n        this.addCollisionPlane(new BABYLON.Vector3(1, 0, 0), terrainSize / 2);\n        this.addCollisionPlane(new BABYLON.Vector3(-1, 0, 0), terrainSize / 2);\n        this.addCollisionPlane(new BABYLON.Vector3(0, 1, 0), 0);\n\n        this._ground = BABYLON.MeshBuilder.CreateGround(\n            \"ground\",\n            { width: terrainSize, height: terrainSize },\n            this._scene\n        );\n        this._ground.setEnabled(false);\n    }\n\n    public async _run() {\n        // Get collision meshes\n        this._sphere = this._collisionObjects[0][0];\n        this._box = this._collisionObjects[1][0];\n        this._heightMap = this._collisionObjects[2];\n        this._groundCollision = this._collisionObjects[7][1];\n\n        this._groundCollision.disabled = true;\n        this._ground.material = this._heightMap[0]!.material;\n\n        const camera =\n            this._scene.activeCameras?.[0] ?? this._scene.activeCamera;\n\n        if (camera) {\n            (camera as BABYLON.ArcRotateCamera).alpha = 4.65;\n            (camera as BABYLON.ArcRotateCamera).beta = 1.12;\n            (camera as BABYLON.ArcRotateCamera).radius = 3.9;\n        }\n\n        this._fluidRenderObject.targetRenderer.blurThicknessFilterSize = 12;\n        this._fluidRenderObject.targetRenderer.blurThicknessNumIterations = 3;\n        this._fluidRenderObject.targetRenderer.specularPower = 50;\n        this._fluidRenderObject.targetRenderer.refractionStrength = 0.02;\n        this._fluidRenderObject.targetRenderer.density = 5;\n\n        this._createParticleGenerator();\n\n        super._run();\n    }\n\n    private _createParticleGenerator(): void {\n        this._particleGenerator?.dispose();\n\n        let particleSize = \"\";\n\n        switch (this._particleGeneratorName) {\n            case \"Water jet\":\n                this._fluidRenderObject.object.particleSize = 0.08;\n\n                this._fluidSim!.smoothingRadius = 0.04;\n                this._fluidSim!.densityReference = 20000;\n                this._fluidSim!.pressureConstant = 3;\n                this._fluidSim!.viscosity = 0.01;\n                this._fluidSim!.maxVelocity = 3;\n                this._fluidSim!.maxAcceleration = 2000;\n                break;\n            case \"Dragon 0.04\":\n            case \"Dude 0.04\":\n            case \"Sphere 0.04\":\n                this._fluidRenderObject.object.particleSize = 0.08;\n\n                this._fluidSim!.smoothingRadius = 0.08;\n                this._fluidSim!.densityReference = 6000;\n                this._fluidSim!.pressureConstant = 10;\n                this._fluidSim!.viscosity = 0.01;\n                this._fluidSim!.maxVelocity = 4;\n                this._fluidSim!.maxAcceleration = 2000;\n\n                particleSize = \"04\";\n                break;\n            case \"Dragon 0.03\":\n            case \"Dude 0.03\":\n            case \"Sphere 0.03\":\n                this._fluidRenderObject.object.particleSize = 0.06;\n\n                this._fluidSim!.smoothingRadius = 0.06;\n                this._fluidSim!.densityReference = 17000;\n                this._fluidSim!.pressureConstant = 15;\n                this._fluidSim!.viscosity = 0.01;\n                this._fluidSim!.maxVelocity = 4;\n                this._fluidSim!.maxAcceleration = 2000;\n\n                particleSize = \"03\";\n                break;\n        }\n\n        this._fluidRendererGUI?.syncGUI();\n        this._syncFluidSimGUI();\n\n        this._particleGenerator = new ParticleGenerator(\n            this._scene,\n            particleSize === \"\"\n                ? undefined\n                : this._particleGeneratorName\n                      .substring(0, this._particleGeneratorName.indexOf(\" \"))\n                      .toLocaleLowerCase() +\n                  \"_\" +\n                  particleSize\n        );\n\n        this._particleGenerator!.position.y = 2;\n        this._particleGenerator!.position.z = 0.3;\n        this._particleGenerator.particleRadius =\n            this._fluidSim!.smoothingRadius / 2;\n    }\n\n    public dispose() {\n        super.dispose();\n\n        this._ground.dispose();\n    }\n\n    protected _makeGUIMainMenu(): void {\n        const params = {\n            restart: () => {\n                this._generateParticles();\n            },\n            particleGeneratorName: this._particleGeneratorName,\n            showHeightmap: this._showHeightmap,\n        };\n\n        const mainMenu = this._gui!;\n\n        mainMenu.add(params, \"restart\").name(\"Restart\");\n\n        mainMenu\n            .add(params, \"particleGeneratorName\", [\n                \"Water jet\",\n                \"Dragon 0.04\",\n                \"Dude 0.04\",\n                \"Sphere 0.04\",\n                \"Dragon 0.03\",\n                \"Dude 0.03\",\n                \"Sphere 0.03\",\n            ])\n            .name(\"Particle generator\")\n            .onChange(async (value: any) => {\n                this._particleGeneratorName = value;\n                this._createParticleGenerator();\n                await this._generateParticles();\n                if (value !== \"Water jet\") {\n                    this._numParticles =\n                        this._particleGenerator!.currNumParticles;\n                }\n                this._syncFluidSimGUI();\n            });\n\n        mainMenu\n            .add(params, \"showHeightmap\")\n            .name(\"Show height map\")\n            .onChange((value: boolean) => {\n                this._showHeightmap = value;\n                this._ground.setEnabled(!value);\n                this._groundCollision.disabled = value;\n                this._heightMap[0]!.setEnabled(value);\n                this._heightMap[1]!.disabled = !value;\n            });\n    }\n\n    protected _checkCollisions(particleRadius: number): void {\n        this._sphere!.position.x = Math.cos((2 * this._time) / 3.3) * 1.1;\n        this._sphere!.position.z = Math.sin((5 * this._time) / 3.3) * 1.1;\n\n        this._box!.rotation.y = this._time * 2;\n\n        this._time += 0.02;\n\n        super._checkCollisions(particleRadius);\n    }\n}\n"],"names":["FluidSimulationDemoHeightMap","FluidSimulationDemoBase","constructor","scene","super","this","_numParticles","_particleGeneratorName","_time","_showHeightmap","_sphere","_box","_heightMap","_groundCollision","terrainSize","addCollisionSphere","addCollisionBox","Math","PI","addCollisionTerrain","addCollisionPlane","_ground","width","height","_scene","setEnabled","async","_collisionObjects","disabled","material","camera","activeCameras","activeCamera","alpha","beta","radius","_fluidRenderObject","targetRenderer","blurThicknessFilterSize","blurThicknessNumIterations","specularPower","refractionStrength","density","_createParticleGenerator","_run","_particleGenerator","dispose","particleSize","object","_fluidSim","smoothingRadius","densityReference","pressureConstant","viscosity","maxVelocity","maxAcceleration","_fluidRendererGUI","syncGUI","_syncFluidSimGUI","ParticleGenerator","undefined","substring","indexOf","toLocaleLowerCase","position","y","z","particleRadius","_makeGUIMainMenu","params","restart","_generateParticles","particleGeneratorName","showHeightmap","mainMenu","_gui","add","name","onChange","value","currNumParticles","_checkCollisions","x","cos","sin","rotation"],"sourceRoot":""}